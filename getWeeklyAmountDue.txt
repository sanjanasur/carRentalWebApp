SELECT o.OwnerId,c.VehicleType,COUNT(r.CarID) AS Total_Cars,SUM(r.AmountDue) AS Total_Earnings,SUM(r.AmountDue) / COUNT(r.CarID) AS Earnings_Per_Car FROM OWNER o JOIN CAR c ON o.OwnerId = c.OwnerId LEFT JOIN RENTS r ON c.VehicleID = r.CarID WHERE r.Status = 'Active' AND r.StartDate >= DATE_SUB(CURDATE(), INTERVAL 7 DAY) AND r.StartDate <= CURDATE() GROUP BY o.OwnerId, c.VehicleType ORDER BY o.OwnerId, c.VehicleType;